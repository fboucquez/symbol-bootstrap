name: build
on: [push]
jobs:
    build:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version: [12.x, 14.x, 15.x]
        steps:
            - uses: actions/checkout@v2
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v2
              with:
                  node-version: ${{ matrix.node-version }}
                  registry-url: https://registry.npmjs.org
            - run: npm ci
            - run: npm pack
            - run: npm test
            - name: Coveralls
              uses: coverallsapp/github-action@master
              with:
                  github-token: ${{ secrets.GITHUB_TOKEN }}
#        steps:
#            - uses: actions/checkout@v2
#            - run: sudo rm /usr/local/bin/docker-compose
#            - run: curl -L https://github.com/docker/compose/releases/download/${env.DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
#            - run: chmod +x docker-compose
#            - sudo mv docker-compose /usr/local/bin
#            - name: Build symbol.yml
#              run: python3 -m catparser --schema symbol/all.cats --include symbol --output  dist/symbol.yml
#            - name: Build nem.yml
#              run: python3 -m catparser --schema nem/all.cats --include nem --output  dist/nem.yml
#            - run: ls -la dist
#            - uses: 'marvinpinto/action-automatic-releases@latest'
#              name: Publish Pre Release
#              if: github.ref == 'refs/heads/main'
#              with:
#                  repo_token: '${{ secrets.GITHUB_TOKEN }}'
#                  automatic_release_tag: 'alpha'
#                  prerelease: true
#                  title: 'Alpha Build'
#                  files: |
#                      dist/symbol.yml
#                      dist/nem.yml
